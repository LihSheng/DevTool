<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev Tools - JSON Formatter & QueryLog Analyzer</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ†Ô∏è</text></svg>">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="app-layout">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <h1>üõ†Ô∏è</h1>
                    <span>Dev Tools</span>
                </div>
                <label class="toggle-switch dark-mode-toggle">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider"></span>
                    <span class="toggle-label">üåô</span>
                </label>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-btn" data-tool="json-formatter">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-text">JSON Formatter</span>
                </button>
                <button class="nav-btn active" data-tool="querylog-analyzer">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-text">QueryLog Analyzer</span>
                </button>
                <button class="nav-btn" data-tool="vm-connector">
                    <span class="nav-icon">üñ•Ô∏è</span>
                    <span class="nav-text">VM File Connector</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <small>Clean utilities for developers</small>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- JSON Formatter Tool -->
            <div id="json-formatter" class="tool-panel">
                <div class="tool-content json-layout">
                    <div class="input-section">
                        <label for="json-input">Raw JSON:</label>
                        <textarea id="json-input" placeholder="Paste your JSON here..."></textarea>
                        <div class="button-group">
                            <button id="format-json">Format JSON</button>
                            <button id="minify-json">Minify</button>
                            <button id="validate-json">Validate</button>
                            <button id="clear-json">Clear</button>
                        </div>
                    </div>

                    <div class="output-section">
                        <label for="json-output">Formatted JSON:</label>
                        <textarea id="json-output" readonly></textarea>
                        <button id="copy-json">Copy to Clipboard</button>
                    </div>
                </div>

                <div id="json-status" class="status-message"></div>
            </div>

            <!-- QueryLog Analyzer Tool -->
            <div id="querylog-analyzer" class="tool-panel active">

                <div class="tool-content querylog-layout">
                    <div class="input-section full-width">
                        <label for="querylog-input">QueryLog Data:</label>
                        <textarea id="querylog-input"
                            placeholder="Paste Laravel QueryLog array or JSON here..."></textarea>
                        <div class="button-group">
                            <button id="analyze-queries">Analyze Queries</button>
                            <button id="clear-querylog">Clear</button>
                            <button id="show-history">History</button>
                            <button id="toggle-querylog-input" title="Collapse QueryLog Data">‚ñ≤</button>
                        </div>
                    </div>

                    <div class="stats-section full-width">
                        <div class="stats-inline">
                            <div class="stat-item">
                                <span class="stat-label">Queries:</span>
                                <span class="stat-value" id="total-queries">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Total:</span>
                                <span class="stat-value" id="total-time">0ms</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Average:</span>
                                <span class="stat-value" id="avg-time">0ms</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Slowest:</span>
                                <span class="stat-value" id="slowest-time">0ms</span>
                            </div>
                        </div>
                    </div>

                    <div class="queries-section full-width">
                        <div class="queries-list">
                            <div class="queries-header">
                                <h3>Query Details</h3>
                                <div class="query-search-controls">
                                    <div class="search-container">
                                        <input type="text" id="query-search" placeholder="Search queries..." class="query-search-input">
                                        <button id="clear-search" class="clear-search-btn" title="Clear search">‚úï</button>
                                    </div>
                                    <div class="query-controls">
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="bind-values-toggle" checked>
                                            <span class="slider"></span>
                                            <span class="toggle-label">Show Bound Values</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="sort-by-time-toggle" checked>
                                            <span class="slider"></span>
                                            <span class="toggle-label">Sort by Time</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div id="queries-table"></div>
                        </div>
                    </div>
                </div>

                <div id="querylog-status" class="status-message"></div>
            </div>

            <!-- VM File Connector Tool -->
            <div id="vm-connector" class="tool-panel vm-layout">

                <!-- Compact VM Settings Bar -->
                <div class="vm-settings-bar">
                    <div class="vm-status-compact">
                        <span class="status-indicator">üîó</span>
                        <span id="connection-info">Using default configuration</span>
                    </div>
                    <div class="vm-controls-compact">
                        <button id="toggle-vm-settings" class="settings-toggle-btn">‚öôÔ∏è Settings</button>
                        <button id="reload-defaults" class="secondary-btn">üîÑ</button>
                    </div>
                </div>

                <!-- Collapsible VM Settings -->
                <div id="vm-settings-form" class="vm-settings-form-compact hidden">
                    <div class="settings-grid-compact">
                        <input type="text" id="vm-host" placeholder="Host/IP">
                        <input type="number" id="vm-port" value="22" placeholder="Port">
                        <input type="text" id="vm-username" placeholder="Username">
                        <input type="password" id="vm-password" placeholder="Password">
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="vm-main-content">
                    <!-- Left Panel: File Browser -->
                    <div class="file-explorer-panel">
                        <div class="explorer-header">
                            <div class="path-navigation">
                                <input type="text" id="current-directory" value="/" placeholder="/home/user">
                                <button id="browse-directory" class="browse-btn">üìÇ</button>
                            </div>
                            <div class="explorer-controls">
                                <label class="toggle-switch-mini">
                                    <input type="checkbox" id="browser-mode-toggle" checked>
                                    <span class="slider-mini"></span>
                                    <span class="toggle-label-mini">Browser</span>
                                </label>
                            </div>
                        </div>

                        <!-- File Browser -->
                        <div id="file-browser-section" class="file-browser-section">
                            <div id="file-browser" class="file-browser-enhanced">
                                <div class="browser-placeholder">
                                    Click üìÇ to explore directories
                                </div>
                            </div>
                        </div>

                        <!-- Manual Path Mode -->
                        <div id="manual-path-section" class="manual-path-section hidden">
                            <input type="text" id="vm-file-path" placeholder="Enter file path...">
                            <button id="connect-vm" class="primary-btn">Get File</button>
                        </div>
                    </div>

                    <!-- Right Panel: File Preview -->
                    <div class="file-preview-panel">
                        <div class="preview-header">
                            <span id="preview-title">Select a file to preview</span>
                            <div class="preview-actions hidden" id="preview-actions">
                                <button id="copy-file-content" class="action-btn">üìã</button>
                                <button id="download-file" class="action-btn">üíæ</button>
                            </div>
                        </div>
                        <div id="vm-file-content" class="file-preview-content">
                            <div class="preview-placeholder">
                                <div class="placeholder-icon">üìÑ</div>
                                <p>No file selected</p>
                                <small>Browse and click on a file to view its contents</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="vm-status" class="status-message"></div>
            </div>

        </main>
    </div>

    <!-- Global Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- History Modal -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>QueryLog History</h3>
                <button class="modal-close" id="close-history">&times;</button>
            </div>
            <div class="modal-body">
                <div id="history-list" class="history-list">
                    <p class="no-history">No history available</p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="clear-history">Clear All History</button>
            </div>
        </div>
    </div>

    <script src="js/notifications.js"></script>
    <script src="js/json-formatter.js"></script>
    <script src="js/querylog-analyzer.js"></script>
    <script src="js/vm-connector.js"></script>
    <script>
        // Navigation functionality
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const toolName = btn.dataset.tool;

                // Update active nav button
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // Show/hide tool panels
                document.querySelectorAll('.tool-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                document.getElementById(toolName).classList.add('active');
            });
        });

        // Dark mode functionality
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const body = document.body;

        // Check for saved theme preference or default to dark mode
        const savedTheme = localStorage.getItem('theme') || 'dark';
        if (savedTheme === 'dark') {
            body.setAttribute('data-theme', 'dark');
            darkModeToggle.checked = true;
        }

        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                body.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                body.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
            }
        });

        // Set dark mode as default on first visit
        if (!localStorage.getItem('theme')) {
            body.setAttribute('data-theme', 'dark');
            darkModeToggle.checked = true;
            localStorage.setItem('theme', 'dark');
        }
    </script>
</body>

</html>